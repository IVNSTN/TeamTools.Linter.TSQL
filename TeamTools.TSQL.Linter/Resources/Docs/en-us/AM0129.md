

# Ambiguous intent in partitioning index on partitioned table

|||
|-|-|
| Id | **AM0129**
| Mnemo | AMBIGUOUS_INDEX_PARTITIONING
| Severity | ⚠ Warning
| Category | [Ambiguity](./Category_Ambiguity.md)
| Source code | [PartitionedTableIndexOptionsRule.cs](../../../Rules/Ambiguity/PartitionedTableIndexOptionsRule.cs)

## Cause

<p id="descr">This rule is triggered if no filegroup is specified to place the index on the partitioned table.</p>

## Examples

Bad

```sql
-- partitioned table dbo.log
CREATE NONCLUSTERED INDEX ix_dbo_log_id ON dbo.log (id); -- partitioned index
CREATE NONCLUSTERED INDEX ix_dbo_log_log_level ON dbo.log (log_level); -- partitioned index
CREATE NONCLUSTERED INDEX ix_dbo_log_inserted_by ON dbo.log (inserted_by) ON [DEFAULT]; -- partitioned index
```

Good

```sql
-- partitioned table dbo.log
CREATE NONCLUSTERED INDEX ix_dbo_log_id ON dbo.log (id) ON log_partitions(inserted_at); -- partitioned index
CREATE NONCLUSTERED INDEX ix_dbo_log_log_level ON dbo.log (log_level) ON [PRIMARY]; -- nonpartitioned index
```

## Tips

💡 If you are creating an index on a partitioned table, and don't specify a filegroup on which to place the index, the index is partitioned in the same manner as the underlying table. This is because indexes, by default, are placed on the same filegroups as their underlying tables, and for a partitioned table in the same partition scheme that uses the same partitioning columns. When the index uses the same partition scheme and partitioning column as the table, the index is aligned with the table.

💡 "default" does not indicate the database default filegroup in the context of CREATE INDEX. This differs from CREATE TABLE, where "default" locates the table on the database default filegroup. It creates the specified index on the same filegroup or partition scheme as the table or view.

## Links

[CREATE INDEX. Partitioned indexes.](https://learn.microsoft.com/en-us/sql/t-sql/statements/create-index-transact-sql?view=sql-server-ver16#partitioned-indexes)
