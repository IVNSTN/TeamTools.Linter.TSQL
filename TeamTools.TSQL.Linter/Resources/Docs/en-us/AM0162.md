

# Ambiguous system table reference: INSERTED/DELETED from OUTPUT or from the trigger

|||
|-|-|
| Id | **AM0162**
| Mnemo | OUTPUT_IN_TRIGGER_AMBIGUOUS_INSDEL
| Severity | ⚠ Warning
| Category | [Ambiguity](./Category_Ambiguity.md), [Triggers](./Group_Triggers.md)
| Source code | [ReferencingInsertedDeletedInOutputInTriggerRule.cs](../../../Rules/Ambiguity/ReferencingInsertedDeletedInOutputInTriggerRule.cs)

## Cause

<p id="descr">This rule is triggered if there is an OUTPUT clause where the column prefix is INSERTED/DELETED and a FROM clause where the special table INSERTED/DELETED is used together in the trigger query.</p>

## Examples

Bad

```sql
-- somwhere in trigger
DELETE bk
OUTPUT DELETED.ID -- DELETED is alias for book_archive
INTO dbo.book_archive (ID)
FROM dbo.book AS bk
INNER JOIN DELETED
    ON bk.ID = DELETED.ID; -- DELETED is special table
```

Good

```sql
-- somwhere in trigger
DELETE bk
OUTPUT DELETED.ID
INTO dbo.book_archive (ID)
FROM dbo.book AS bk
INNER JOIN DELETED AS del 
    ON bk.ID = del.ID;
```

## Tips

💡 If INSERTED/DELETED used in OUTPUT together with INSERTED/DELETED in FROM inside TRIGGER make server dump. Whenever possible avoid using OUTPUT clause inside triggers code.

💡 You should avoid this kind of code, because it is quite difficult to read.
