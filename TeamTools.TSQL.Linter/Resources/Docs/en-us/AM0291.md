

# Missing CLUSTERED/NONCLUSTERED index option

|||
|-|-|
| Id | **AM0291**
| Mnemo | INDEX_CLUSTERED_OR_NOT
| Severity | ⚠ Warning
| Category | [Ambiguity](./Category_Ambiguity.md), [Indices](./Group_Indices.md)
| Source code | [IndexClusteredAmbiguityRule.cs](../../../Rules/Ambiguity/IndexClusteredAmbiguityRule.cs)

## Cause

This rule is triggered if the index creation script does not explicitly specify whether it is clustered or not.
<p id="descr">Explicitly specify whether the index is clustered or not.</p>

## Examples

Bad

```sql
CREATE TABLE dbo.bar
(
    id INT NOT NULL
    , order_date DATETIME
    , INDEX IX_order_date (order_date)
    , UNIQUE (order_date)
)

CREATE INDEX IX_1 ON dbo.zar (name);

CREATE UNIQUE INDEX IX_2 ON dbo.far (order_date);
```

Good

```sql
CREATE TABLE dbo.foo (
    id INT NOT NULL PRIMARY KEY CLUSTERED
);

CREATE TABLE dbo.bar
(
    id           INT NOT NULL
    , order_date DATETIME
    , INDEX IX_order_date NONCLUSTERED (order_date)
    , UNIQUE NONCLUSTERED (order_date)
    , CONSTRAINT PK_bar PRIMARY KEY CLUSTERED (id)
);

CREATE TABLE dbo.zar (
    id INT NOT NULL
    , CONSTRAINT PK_bar PRIMARY KEY NONCLUSTERED (id)
);

CREATE CLUSTERED INDEX IX_1 ON dbo.zar (name);

CREATE NONCLUSTERED INDEX IX_2
    ON dbo.far (order_date);

CREATE TABLE #bar
(
    id INT NOT NULL
    , order_date DATETIME
    , INDEX IX_order_date (order_date)
    , UNIQUE (order_date)
)
```

## Tips

💡 Yes, in PRIMARY KEY it is also mandatory.

💡 In inline UNIQUE, INDEX definitions it is also mandatory.

💡 For inline definitions, an exception is made for temporary objects @ and #. There, it's not particularly important. But when creating an index for # in the form of a CREATE INDEX expression, you still need to specify it.
