

# Multiple output to the same variable

|||
|-|-|
| Id | **AM0903**
| Mnemo | SAME_VAR_MULTIPLE_OUTPUT
| Severity | ⚠ Warning
| Category | [Ambiguity](./Category_Ambiguity.md)
| Source code | [MultipleOutputToSameVariableRule.cs](../../../Rules/Ambiguity/MultipleOutputToSameVariableRule.cs)

## Cause

This rule is triggered if multiple stored procedure parameters are returned to the same variable.
<p id="descr">Use different variables.</p>

## Examples

Bad

```sql
EXEC @var = my_proc
    @var = @var OUTPUT,
    @dt  = @var OUTPUT;

EXEC my_proc
    @var = @var OUTPUT,
    @dt  = @var OUTPUT;

exec sp_executesql N'dummy', N'dummy',
    @var = @var OUTPUT,
    @dt  = @var OUTPUT;
```

Good

```sql
EXEC my_proc

EXEC my_proc @foo, 'bar', @dar OUTPUT

EXEC @res = my_proc
    @p   = @v,
    @var = @foo OUTPUT,
    @dt  = @bar OUTPUT;

EXEC @res = sp_executesql N'dummy', N'dummy',
    @p   = 'p',
    @var = @foo OUTPUT,
    @dt  = @bar OUTPUT;
```

## Tips

💡 Returning from multiple parameters of stored procedure to the same variable does not make sense and is most likely a logical error.\
Example of bad code:

```sql
EXEC @var = dbo.my_proc
    @param_a = 'a',
    @param_b = @var OUTPUT,
    @param_c = @var OUTPUT;
```

Here, the same @var variable is used to store the output from the stored procedure call three times: the RETURN value and the OUT from the param_b and param_c parameters. It is unclear what the author of such a call is counting on.

💡 If you do not need the values ​​from the OUTPUT parameters, but they are required to be specified in the stored procedure call, then instead of fictitious transfer to a garbage variable, simply pass NULL or another scalar without specifying the OUTPUT option. If you do not need the RETURN value returned by the stored procedure, then simply do not store it anywhere.
