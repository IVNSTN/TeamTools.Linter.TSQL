

# Computed column is before persisted column

|||
|-|-|
| Id | **CD0215**
| Mnemo | COMPUTED_COLS_ORDER
| Severity | ⚠ Warning
| Category | [ContinuousDelivery](./Category_ContinuousDelivery.md)
| Source code | [ComputedColumnsOrderRule.cs](../../../Rules/ContinuousDeployment/ComputedColumnsOrderRule.cs)

## Cause

This rule is triggered if calculated columns are defined before persistent columns in the table definition script.
<p id="descr">Place all calculated columns at the end of the table.</p>

## Examples

Bad

```sql
CREATE TABLE a
(
    b   INT     NOT NULL DEFAULT 1
    , bar AS CASE WHEN Id  = 1 OR Id = 2 OR Id = 3 THEN 10 ELSE 100 END
    , c CHAR(1) NULL DEFAULT 'd'
);
GO
```

Good

```sql
CREATE TABLE a
(
    b   INT     NOT NULL DEFAULT 1
    , c CHAR(1) NULL DEFAULT 'd'
    , bar AS CASE WHEN Id  = 1 OR Id = 2 OR Id = 3 THEN 10 ELSE 100 END
);
GO
```

## Tips

💡 Calculated columns cannot be changed, they can only be deleted and added again. This will change the order of the columns, and if the column was in the middle, then after adding it it will be at the end.

DacFx performs the changes in a way to preserve the order of the columns. To do this, it refills the table, recreating all the columns in the same order as they were. This is a difficult operation that should be avoided.

If all the calculated columns are at the end of the table, changing the first one will be easy. The table will not be overfilled with data. Only those calculated columns that come after the one being modified will be deleted and recreated. The script will have one simple DROP statement and a more complex ADD statement with columns and expressions to calculate them.
