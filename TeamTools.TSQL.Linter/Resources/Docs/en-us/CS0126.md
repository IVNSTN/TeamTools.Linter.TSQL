

# Reading @@ROWCOUNT after NOCOUNT change

|||
|-|-|
| Id | **CS0126**
| Mnemo | BAD_ROWCOUNT_CHECK
| Severity | ⚠ Warning
| Category | [CodeSmell](./Category_CodeSmell.md)
| Source code | [RowCountAfterNoCountRule.cs](../../../Rules/CodeSmell/RowCountAfterNoCountRule.cs)

## Cause

This rule is triggered if `@@ROWCOUNT` is used after statements or expressions that make such a `@@ROWCOUNT` check meaningless.
<p id="descr">Verify the @@ROWCOUNT check logic.</p>

## Examples

Bad

```sql
DECLARE @a INT;

SET NOCOUNT ON;

SET @a = 1; -- always sets ROWCOUNT to 1

SELECT @@ROWCOUNT;

SELECT a, b, c FROM dbo.foo WHERE a = @a;

SET ANSI_WARNINGS ON; -- always sets ROWCOUNT to 0

SELECT @@ROWCOUNT;
```

Good

```sql
SET NOCOUNT, ANSI_WARNINGS ON;

DECLARE @a INT = 1;

SELECT a, b, c FROM dbo.foo WHERE a = @a;

SELECT @@ROWCOUNT;
```

## Tips

💡 The rule checks that between the `SET NOCOUNT ON` setting and the call to `@@ROWCOUNT` there are expressions that can change this counter, otherwise calls to `@@ROWCOUNT` do not make sense.

💡 Assigning a value to a variable actually shifts `@@ROWCOUNT`, but after this, checking `@@ROWCOUNT` is somewhat pointless, so the rule also triggers for such expressions.
