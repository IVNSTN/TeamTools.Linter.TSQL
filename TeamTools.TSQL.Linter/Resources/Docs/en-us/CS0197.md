

# The order of cursor handling commands is incorrect

|||
|-|-|
| Id | **CS0197**
| Mnemo | CURSOR_COMMAND_ORDER
| Severity | ⚠ Warning
| Category | [CodeSmell](./Category_CodeSmell.md), [Cursors](./Group_Cursors.md)
| Source code | [CursorCommandOrderRule.cs](../../../Rules/CodeSmell/CursorCommandOrderRule.cs)

## Cause

This rule is triggered when the order of cursor handling commands is incorrect.
<p id="descr">Fix the order of cursor handling commands.</p>

## Examples

Bad

```sql
DECLARE cr CURSOR READ_ONLY FOR
    SELECT 1;
OPEN cr;
FETCH NEXT FROM cr INTO @id;

WHILE @@FETCH_STATUS = 0
BEGIN
    FETCH NEXT FROM cr INTO @id;
END;

CLOSE cr;
```

Good

```sql
DECLARE cr CURSOR READ_ONLY FOR
    SELECT 1;
OPEN cr;
FETCH NEXT FROM cr INTO @id;

WHILE @@FETCH_STATUS = 0
BEGIN
    FETCH NEXT FROM cr INTO @id;
END;

CLOSE cr;
DEALLOCATE cr;
```

## Tips

💡 Expected order of commands:

- DECLARE
- OPEN
- FETCH
- CLOSE
- DEALLOCATE
