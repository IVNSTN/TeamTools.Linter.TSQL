

# Set-based operations are preferred over cursors for update

|||
|-|-|
| Id | **CS0745**
| Mnemo | CURSOR_FOR_UPDATE
| Severity | ⚠ Warning
| Category | [CodeSmell](./Category_CodeSmell.md)
| Source code | [CursorForUpdateRule.cs](../../../Rules/CodeSmell/CursorForUpdateRule.cs)

## Cause

The rule is triggered if there is a cursor for updating CURSOR FOR UPDATE OF.
<p id="descr">Replace the cursor with the UPDATE query.</p>

## Examples

Bad

```sql
...
DECLARE EMP_CURSOR CURSOR FOR
SELECT id, ins_date FROM dbo.my_table
FOR UPDATE OF ins_date
...
```

Good

```sql
UPDATE MT
SET MT.ins_date = GETDATE()
FROM dbo.my_table AS MT
WHERE ...
```

## Tips

💡 If it is possible, rewrite the CURSOR FOR UPDATE OF in an UPDATE or MERGE statement. It is better to use this method. It is not advisable to use cursors for working with database tables.

## Links

[UPDATE (Transact-SQL)](https://learn.microsoft.com/en-us/sql/t-sql/queries/update-transact-sql?view=sql-server-ver16)

[MERGE (Transact-SQL)](https://learn.microsoft.com/en-us/sql/t-sql/statements/merge-transact-sql?view=sql-server-ver16)

[CURSOR FOR UPDATE OF](https://learn.microsoft.com/en-us/sql/t-sql/language-elements/declare-cursor-transact-sql?view=sql-server-ver16#for-update--of-column_name--n--)
