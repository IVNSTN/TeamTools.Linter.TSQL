

# Unreliable type check

|||
|-|-|
| Id | **CS0960**
| Mnemo | UNRELIABLE_TYPE_CHECK
| Severity | ⚠ Warning
| Category | [CodeSmell](./Category_CodeSmell.md)
| Source code | [UnreliableTypeCheckRule.cs](../../../Rules/CodeSmell/UnreliableTypeCheckRule.cs)

## Cause

The rule is triggered if the string content is checked for numeric type or date using the ISNUMERIC and ISDATE functions.
<p id="descr">To check the data type, use TRY_CONVERT.</p>

## Examples

Bad

```sql
SELECT ISNUMERIC('$100,00'), ISDATE('04/15/2008');
```

Good

```sql
SELECT TRY_CAST('$100,00' AS DECIMAL(5, 2)), TRY_CONVERT(DATETIME, '04/15/2008', 101);
...
```

## Tips

💡 **ISNUMERIC** allows the dollar symbol and a comma as a decimal separator, but you can not convert such text to DECIMAL using SQL Server conversion tools.

💡 **ISDATE** is based on the culture, language, and date format currently selected in the session or batch (settings **SET LANGUAGE**, **SET DATEFORMAT**). In order for the check to work correctly, you either need to constantly set a certain culture, or assume that the correct value will always be set, which cannot be guaranteed. There are many date formats, and the position of the month and day in the date may vary. It is better to use the **CONVERT**/**TRY_CONVERT** functions with a specific format.

💡 Use the **PARSE, CAST** and **CONVERT** functions if an exception must be raised in case of an incorrect value format. If the error is not critical, and the result of the conversion should be **NULL**, then use **TRY_PARSE, TRY_CAST** and **TRY_CONVERT**.

## Links

[Functions CAST и CONVERT](https://learn.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql?view=sql-server-ver16)

[Functions PARSE](https://learn.microsoft.com/en-us/sql/t-sql/functions/parse-transact-sql?view=sql-server-ver16)

[Function TRY_CONVERT](https://learn.microsoft.com/en-us/sql/t-sql/functions/try-convert-transact-sql?view=sql-server-ver16)

[Function TRY_CAST](https://learn.microsoft.com/en-us/sql/t-sql/functions/try-cast-transact-sql?view=sql-server-ver16)

[Function TRY_PARSE](https://learn.microsoft.com/en-us/sql/t-sql/functions/try-parse-transact-sql?view=sql-server-ver16)

[Function ISNUMERIC](https://learn.microsoft.com/en-us/sql/t-sql/functions/isnumeric-transact-sql?view=sql-server-ver16)

[Function ISDATE](https://learn.microsoft.com/en-us/sql/t-sql/functions/isdate-transact-sql?view=sql-server-ver16)
