
# Unexpected sorting of CTE output

|||
|-|-|
| Id | **PF0720**
| Mnemo | SORTED_CTE
| Severity | ⚠ Warning
| Category | [Performance](./Category_Performance.md)
| Source code | [SortedOutputFromCteRule.cs](../../../Rules/Performance/SortedOutputFromCteRule.cs)

## Cause

This rule is triggered if the code detects sorting of the resulting data set in `CTE`.
<p id="descr">Delete the sorting.</p>

## Examples

Bad

```sql
WITH foo AS (
    SELECT TOP 100 PERCENT a, b, c
    FROM dbo.bar
    ORDER BY a DESC
)
SELECT a, b, c
FROM foo;
```

Good

```sql
WITH foo AS (
    SELECT a, b, c
    FROM dbo.bar
)
SELECT a, b, c
FROM foo
ORDER BY a DESC;
```

## Tips

💡 It is not necessary to sort the result set in `CTE`, as they are embedded in other queries where the final sorting will be performed. Sorting in `CTE` is either redundant or may lead to an unreliable solution.
