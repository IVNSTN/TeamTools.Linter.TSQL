

# Unexpected sorting of CTE output

|||
|-|-|
| Id | **PF0720**
| Mnemo | SORTED_CTE
| Severity | ⚠ Warning
| Category | [Performance](./Category_Performance.md)
| Source code | [SortedOutputFromCteRule.cs](../../../Rules/Performance/SortedOutputFromCteRule.cs)

## Cause

<p id="descr">There is no need to sort the result set of CTEs, as they are embedded in other queries where the final sorting will be applied. Sorting within CTEs is either redundant or may lead to an unreliable solution.</p>

## Examples

Bad

```sql
WITH foo AS (
    SELECT TOP 100 PERCENT a, b, c
    FROM dbo.bar
    ORDER BY a DESC
)
SELECT a, b, c
FROM foo;
```

Good

```sql
WITH foo AS (
    SELECT a, b, c
    FROM dbo.bar
)
SELECT a, b, c
FROM foo
ORDER BY a DESC;
```
