
# SPARSE column not filtered in index

|||
|-|-|
| Id | **PF0775**
| Mnemo | SPARSE_COL_INDEX_FILTER
| Severity | ⚠ Warning
| Category | [Performance](./Category_Performance.md), [Indices](./Group_Indices.md)
| Source code | [SparseColumnIndexFilterRule.cs](../../../Rules/Performance/SparseColumnIndexFilterRule.cs)

## Cause

This rule is triggered if the `NULL` values are not filtered for the `SPARSE` column in the index.
<p id="descr">Filter out NULL values.</p>

## Examples

Bad

```sql
CREATE TABLE dbo.foo (bar INT SPARSE NULL);

CREATE INDEX ix ON dbo.foo (bar);
```

Good

```sql
CREATE TABLE dbo.foo (bar INT SPARSE NULL, far BIT NOT NULL);

-- filtered
CREATE INDEX IXF_dbo_foo_bar
    ON dbo.foo (bar)
    WHERE bar IS NOT NULL;

-- not sparse
CREATE INDEX IX_dbo_foo_far ON dbo.foo (far);

-- not in key
CREATE INDEX IXI_dbo_foo_far ON dbo.foo (far) INCLUDE (bar);
```

## Tips

💡 `SPARSE` columns mostly store `NULL` values, so if you build an index on such columns, it makes sense to discard all `NULL` values, otherwise selectivity will be very poor.
