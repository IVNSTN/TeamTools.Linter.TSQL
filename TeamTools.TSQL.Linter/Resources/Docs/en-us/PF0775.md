

# SPARSE column not filtered in index

|||
|-|-|
| Id | **PF0775**
| Mnemo | SPARSE_COL_INDEX_FILTER
| Severity | ⚠ Warning
| Category | [Performance](./Category_Performance.md), [Indices](./Group_Indices.md)
| Source code | [SparseColumnIndexFilterRule.cs](../../../Rules/Performance/SparseColumnIndexFilterRule.cs)

## Cause

<p id="descr">SPARSE columns primarily store NULL values. Therefore, when creating an index on such columns, it is advisable to exclude all NULL values; otherwise, the index's selectivity will be significantly reduced.</p>

## Examples

Bad

```sql
CREATE TABLE dbo.foo (bar INT SPARSE NULL);

CREATE INDEX ix ON dbo.foo (bar);
```

Good

```sql
CREATE TABLE dbo.foo (bar INT SPARSE NULL, far BIT NOT NULL);

-- filtered
CREATE INDEX IXF_dbo_foo_bar
    ON dbo.foo (bar)
    WHERE bar IS NOT NULL;

-- not sparse
CREATE INDEX IX_dbo_foo_far ON dbo.foo (far);

-- not in key
CREATE INDEX IXI_dbo_foo_far ON dbo.foo (far) INCLUDE (bar);
```
