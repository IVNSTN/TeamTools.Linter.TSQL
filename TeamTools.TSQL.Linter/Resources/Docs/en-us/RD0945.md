

# Redundant permission on specific object when schema granted/denied

|||
|-|-|
| Id | **RD0945**
| Mnemo | REDUNDANT_GRANT
| Severity | ⚠ Warning
| Category | [Redundancy](./Category_Redundancy.md)
| Source code | [RedundantGrantRule.cs](../../../Rules/Redundancy/RedundantGrantRule.cs)

## Cause

This rule is triggered when a permission is granted to a specific object when a permission is already granted to the schema.
<p id="descr">Remove the object permission definition. The permission is already granted to the schema.</p>

## Examples

Bad

```sql
GRANT UPDATE ON dbo.bar
TO usr1;

GRANT SELECT, EXECUTE, UPDATE ON SCHEMA::dbo
TO usr1;
```

Good

```sql
GRANT SELECT, EXECUTE, UPDATE ON SCHEMA::dbo
TO usr1;
```

## Tips

💡 It vefifies that the permission is issued to the same participant and exactly the same permission (INSERT, EXECUTE, REFERENCES and similar).

⚠️ REVOKE is not analyzed.

⚠️ This rule processes only top-level expressions. If the permission expressions are in the body of the stored procedure, they are not analyzed, since there may be a complex algorithm for hitting one or another expression for distributing privileges. The presence of privileges in the business logic is checked by the rule [VU0512](./VU0512.md).
