

# Insecure xp_cmd_shell call

|||
|-|-|
| Id | **VU0504**
| Mnemo | XP_CMD_SHELL
| Severity | ⚠ Warning
| Category | [Vulnerability](./Category_Vulnerability.md)
| Source code | [XpCmdShellCommandRule.cs](../../../Rules/Vulnerability/XpCmdShellCommandRule.cs)

## Cause

The rule is triggered when code runs xp_cmd_shell procedure.
<p id="descr">Remove xp_cmd_shell procedure.</p>

## Examples

Bad

```sql
EXEC xp_cmdshell @a = 'p';
```

## Tips

💡 Choose dedicated schemas and databases for internal and system procedures.

💡 With access to service procedures an ordinary user of the product can directly or indirectly gain access to the management of the DBMS, which is unsafe. Only DBAs can have this level of access.
