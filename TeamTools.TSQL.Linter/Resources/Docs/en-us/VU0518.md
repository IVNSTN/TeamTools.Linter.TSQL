

# Possibly insecure user context switch to schema owner

|||
|-|-|
| Id | **VU0518**
| Mnemo | EXECUTE_AS_OWNER
| Severity | ℹ Hint
| Category | [Vulnerability](./Category_Vulnerability.md)
| Source code | [ExecuteAsOwnerRule.cs](../../../Rules/Vulnerability/ExecuteAsOwnerRule.cs)

## Cause

The rule is triggered when code contains WITH EXECUTE AS OWNER.
<p id="descr">Remove the WITH EXECUTE AS OWNER option.</p>

## Examples

Bad

```sql
CREATE PROCEDURE dbo.foo
WITH EXECUTE AS OWNER
AS
    SELECT 1;
```

Good

```sql
CREATE PROCEDURE dbo.foo
AS
    SELECT 1;
```

## Tips

💡 In most cases all the schemes have a single owner. So the using of AS OWNER clause opens up almost limitless possibilities for the one who runs the current sp, which is unsafe.

💡 The WITH EXECUTE AS CALLER option is the default value, thus it is allowed not to specify it explicitly when creating the procedure.
