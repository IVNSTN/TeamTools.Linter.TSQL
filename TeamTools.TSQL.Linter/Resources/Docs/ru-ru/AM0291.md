

# Не указан тип индекса CLUSTERED/NONCLUSTERED

|||
|-|-|
| Id | **AM0291**
| Мнемо | INDEX_CLUSTERED_OR_NOT
| Серьёзность | ⚠ Предупреждение
| Категория | [Неоднозначность](./Категория_Неоднозначность.md), [Индексы](./Группа_Индексы.md)
| Исходный код | [IndexClusteredAmbiguityRule.cs](../../../Rules/Ambiguity/IndexClusteredAmbiguityRule.cs)

## Причина

<p id="descr">Правило срабатывает, если в скрипте создания индекса не указано кластерный он или нет в явном виде.</p>

## Примеры

Некорректно

```sql
CREATE TABLE dbo.bar
(
    id INT NOT NULL
    , order_date DATETIME
    , INDEX IX_order_date (order_date)
    , UNIQUE (order_date)
)

CREATE INDEX IX_1 ON dbo.zar (name);

CREATE UNIQUE INDEX IX_2 ON dbo.far (order_date);
```

Корректно

```sql
CREATE TABLE dbo.foo (
    id INT NOT NULL PRIMARY KEY CLUSTERED
);

CREATE TABLE dbo.bar
(
    id           INT NOT NULL
    , order_date DATETIME
    , INDEX IX_order_date NONCLUSTERED (order_date)
    , UNIQUE NONCLUSTERED (order_date)
    , CONSTRAINT PK_bar PRIMARY KEY CLUSTERED (id)
);

CREATE TABLE dbo.zar (
    id INT NOT NULL
    , CONSTRAINT PK_bar PRIMARY KEY NONCLUSTERED (id)
);

CREATE CLUSTERED INDEX IX_1 ON dbo.zar (name);

CREATE NONCLUSTERED INDEX IX_2
    ON dbo.far (order_date);

CREATE TABLE #bar
(
    id INT NOT NULL
    , order_date DATETIME
    , INDEX IX_order_date (order_date)
    , UNIQUE (order_date)
)
```

## Подсказки

💡 Да, в PRIMARY KEY тоже обязательно.

💡 В инлайновых определениях UNIQUE, INDEX тоже обязательно.

💡 Для инлайновых определений сделано исключение для временных объектов @ и #. Там это всё не особенно важно. Но при создании индекса для # в виде выражения CREATE INDEX все равно нужно указывать.
