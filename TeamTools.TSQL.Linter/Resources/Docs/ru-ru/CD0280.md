

# Используйте CASE вместо IIF

|||
|-|-|
| Id | **CD0280**
| Мнемо | IIF_IN_CONSTRAINT
| Серьёзность | ⚠ Предупреждение
| Категория | [НепрерывнаяПоставка](./Категория_НепрерывнаяПоставка.md)
| Исходный код | [IifInConstraintRule.cs](../../../Rules/ContinuousDeployment/IifInConstraintRule.cs)

## Причина

Правило срабатывает, если в ограничениях используется `IIF`.
<p id="descr">Вместо IIF используйте блок CASE.</p>

## Примеры

Некорректно

```sql
CREATE TABLE foo
(
    bar DATETIME NOT NULL
    , mar AS IIF(bar < '2020-01-01', 1, 0)
);
```

Корректно

```sql
CREATE TABLE foo
(
    bar DATETIME NOT NULL
    , mar AS CASE WHEN bar < '2020-01-01' THEN 1 ELSE 0 END
);
```

## Подсказки

💡 На временные таблицы (#) и табличные переменные (@) не срабатывает.

💡 DacFx при публикации конвертирует `IIF` в `CASE` и так получается "вечный дифф".
