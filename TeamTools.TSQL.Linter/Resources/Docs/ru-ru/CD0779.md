

# EXECUTE AS SELF нежелателен

|||
|-|-|
| Id | **CD0779**
| Мнемо | EXECUTE_AS_SELF
| Серьёзность | ⚠ Предупреждение
| Категория | [НепрерывнаяПоставка](./Категория_НепрерывнаяПоставка.md)
| Исходный код | [ExecuteAsSelfRule.cs](../../../Rules/ContinuousDeployment/ExecuteAsSelfRule.cs)

## Причина

Срабатывает на EXECUTE AS SELF.
<p id="descr">Уберите EXECUTE AS SELF</p>

## Примеры

Некорректно

```sql
CREATE PROCEDURE foo 
WITH EXECUTE AS SELF
AS
...
```

Корректно

```sql
CREATE PROCEDURE foo 
AS
...
```

## Подсказки

💡 При установленной опции EXECUTE AS SELF контекстом выполнения будет выбран пользователь, под которым выполнялось создание хп в БД. Это может быть полезно при отладке, однако при настроенном CONTINUOUS DEPLOYMENT создание будет выполнено под технической учеткой, никак не связанной с выполнением бизнес-логики, реализованной в коде. А при множестве целевых серверов не факт что вообще можно предположить, под какой учетной записью будет выполнена раскатка. И оставлять этот контекст безопасности в качестве основного странно. Лучше выбрать конкретную техническую учетную запись, оставить AS CALLER или повысить контекст до AS OWNER, смотря что будет корректно для конкретного программного модуля.

💡 Для очередей AS SELF - это значение по умолчанию. Поэтому в выражениях CREATE QUEUE нужно указывать EXECUTE AS всегда в явном виде.
