
# Некорректная адресация привилегий

|||
|-|-|
| Id | **CS0164**
| Мнемо | PERMISSION_MISDIRECTED
| Серьёзность | ⚠ Предупреждение
| Категория | [СомнительноеКодирование](./Категория_СомнительноеКодирование.md)
| Исходный код | [PermissionMisdirectedRule.cs](../../../Rules/CodeSmell/PermissionMisdirectedRule.cs)

## Причина

Правило срабатывает, если файл одной роли содержит разрешение для другой роли.
<p id="descr">Укажите разрешение в файле той роли, на которую он выдается.</p>

## Примеры

Некорректно

```sql
CREATE ROLE Risk AUTHORIZATION dbo;
GO

GRANT SELECT ON SCHEMA::export TO Robots;
GO
```

Корректно

```sql
CREATE ROLE Robots AUTHORIZATION dbo;
GO

GRANT SELECT ON SCHEMA::export TO Robots;
GO
```
