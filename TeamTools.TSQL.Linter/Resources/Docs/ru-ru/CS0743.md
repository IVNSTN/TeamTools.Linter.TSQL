

# Non-invariant functions and subqueries should be avoided in CASE-based expressions

|||
|-|-|
| Id | **CS0743**
| Мнемо | INVARIANT_CASE_ARG
| Серьёзность | ℹ Подсказка
| Категория | [СомнительноеКодирование](./Категория_СомнительноеКодирование.md)
| Исходный код | [InvariantCaseArgumentRule.cs](../../../Rules/CodeSmell/InvariantCaseArgumentRule.cs)

## Причина

<p id="descr">Выражение CASE и основанные на нём фактически оценивают результат вычисления несколько раз: первый раз компилятору нужно разобраться, какой тип будет иметь результат, затем уже нужно просчитать условия и сконвертировать итог в целевой тип данных. Поэтому функции, имеющие нестабильный результат (например, RAND()) могут быть выполнены больше одного раза и, соответственно, результат всего выражения CASE может "скакать" туда-сюда из-за меняющихся входных значений предикатов или вычисленных результатов. По той же причине нежелательно присутствие в CASE-выражениях подзапросов, обращающихся к реальным таблицам.</p>
