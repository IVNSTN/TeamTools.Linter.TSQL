

# Повторное использование имени транзакции

|||
|-|-|
| Id | **CS0931**
| Мнемо | NAME_REUSED_TRANSACTION
| Серьёзность | ⚠ Предупреждение
| Категория | [СомнительноеКодирование](./Категория_СомнительноеКодирование.md)
| Исходный код | [ReusedTranNameRule.cs](../../../Rules/CodeSmell/ReusedTranNameRule.cs)

## Причина

Правило срабатывает, если в коде используются повторяющиеся имена для транзакций или точек сохранения.
<p id="descr">Замените повторяющиеся имена уникальными.</p>

## Примеры

Некорректно

```sql
...
SAVE TRANSACTION tran1
...
   SAVE TRANSACTION tran1
...
```

Корректно

```sql
...
SAVE TRANSACTION tran1
...
   SAVE TRANSACTION tran2
...
```

## Подсказки

⚠️ В транзакции разрешены дублирующие имена точек сохранения, но инструкция ROLLBACK TRANSACTION, содержащая имя точки сохранения, откатывает транзакцию к точке сохранения последней инструкции SAVE TRANSACTION, использовавшей это имя.

💡 Повторное использование имени транзакции может вызвать путаницу и привести к неожиданным последствиям в сложном потоке кода. В некоторых случаях код может быть скомпилирован и даже запущен, но не с той транзакцией, которую имели в виду.

## Ссылки

[SAVE TRANSACTION](https://learn.microsoft.com/ru-ru/sql/t-sql/language-elements/save-transaction-transact-sql?view=sql-server-ver16)

[BEGIN TRANSACTION](https://learn.microsoft.com/ru-ru/sql/t-sql/language-elements/begin-transaction-transact-sql?view=sql-server-ver16)
