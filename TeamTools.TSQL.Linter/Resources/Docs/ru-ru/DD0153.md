

# Составной внешний ключ

|||
|-|-|
| Id | **DD0153**
| Мнемо | FK_MULTIPLE_COL
| Серьёзность | ℹ Подсказка
| Категория | [ДизайнБазДанных](./Категория_ДизайнБазДанных.md)
| Исходный код | [ForeignKeyOnMultipleColumnRule.cs](../../../Rules/DatabaseDesign/ForeignKeyOnMultipleColumnRule.cs)

## Причина

Правило срабатывает, если используется составной внешний ключ.
<p id="descr">Создайте суррогатный ключ.</p>

## Примеры

Некорректно

```sql
CREATE TABLE dbo.foo_types
(
    name CHAR(10) NOT NULL
    , code CHAR(10) NOT NULL
);

CREATE TABLE dbo.foo
(
    id INT NOT NULL PRIMARY KEY
    , type_name CHAR(10) NOT NULL
    , type_code CHAR(10) NOT NULL
    , CONSTRAINT FK_foo_types FOREIGN KEY (type_name, type_code) REFERENCES foo_types(name, code)
);
```

Корректно

```sql
CREATE TABLE dbo.foo_types
(
    id INT IDENTITY(1, 1) NOT NULL
    , name CHAR(10) NOT NULL
    , code CHAR(10) NOT NULL
);

CREATE TABLE dbo.foo
(
    id INT NOT NULL PRIMARY KEY
    , type_id INT NOT NULL
    , CONSTRAINT FK_foo_types FOREIGN KEY (type_id) REFERENCES foo_types(id)
);
```
