

# SPARSE столбец малого размера

|||
|-|-|
| Id | **DD0772**
| Мнемо | SMALL_COL_SPARSE
| Серьёзность | ℹ Подсказка
| Категория | [ДизайнБазДанных](./Категория_ДизайнБазДанных.md)
| Исходный код | [SmallSizeColumnSparseRule.cs](../../../Rules/DatabaseDesign/SmallSizeColumnSparseRule.cs)

## Причина

Правило срабатывает, если опция SPARSE указана для столбца малого размера.
<p id="descr">Удалите опцию SPARSE.</p>

## Примеры

Некорректно

```sql
CREATE TABLE dbo.foo
(
    is_sale   BIT     SPARSE NULL
    , article TINYINT SPARSE NULL
    , code    CHAR(1) SPARSE NULL
);
```

Корректно

```sql
CREATE TABLE dbo.foo
(
    is_sale   BIT     NULL
    , article TINYINT NULL
    , code    CHAR(1) NULL
);
```

## Подсказки

💡 Чтобы SPARSE столбцы давали ощутимый эффект экономии места, должна быть довольно высокая доля NULL-значений, чтобы накладные расходы (дополнительные 4 байта) на хранение каждого не NULL-значения не превысили выгоду от оптимизации.

💡 Правило проверяет типы (для строковых n <= 12):

- BIT
- TINYINT
- SMALLINT
- DATE
- TIME
- SMALLDATETIME
- CHAR
- NCHAR
- VARCHAR
- NVARCHAR
- BINARY
- VARBINARY

## Ссылки

[Предполагаемая экономия места](https://learn.microsoft.com/ru-ru/sql/relational-databases/tables/use-sparse-columns?view=sql-server-ver16#estimated-space-savings-by-data-type)
