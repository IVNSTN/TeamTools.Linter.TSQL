

# Управление индексами из кода

|||
|-|-|
| Id | **DM0729**
| Мнемо | INDEX_MAINTENANCE
| Серьёзность | ⚠ Предупреждение
| Категория | [ОбслуживаниеБазДанных](./Категория_ОбслуживаниеБазДанных.md), [Индексы](./Группа_Индексы.md)
| Исходный код | [IndexMaintenanceRule.cs](../../../Rules/DatabaseMaintenance/IndexMaintenanceRule.cs)

## Причина

Правило срабатывает, если в коде хранимой процедуры или триггера обнаружена команда управления индексами на персистентной таблице.
<p id="descr">Удалите команду управления индексами или используйте временные объекты.</p>

## Примеры

Некорректно

```sql
CREATE INDEX ix_bar ON dbo.bar(id)

ALTER INDEX ix_bar ON dbo.bar REBUILD

DROP INDEX ix_bar ON dbo.bar
```

Корректно

```sql
CREATE INDEX #ix ON #tmp(id)

ALTER INDEX #ix ON #tmp REBUILD

DROP INDEX #ix ON #tmp
```

## Подсказки

💡 Допустимо использование, для работы с индексами на временных таблицах (#) и табличных переменных (@).

💡 Допустимо использование выражений создания индексов (CREATE) в файлах объявления таблиц (CREATE TABLE).

💡 Для служебных и административных хранимых процедур выбирайте специально отведенные для этого схемы и базы данных.
