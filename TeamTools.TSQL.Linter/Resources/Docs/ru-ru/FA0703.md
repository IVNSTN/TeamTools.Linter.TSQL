

# COLUMNSTORE индекс не может содержать столбцы данного типа

|||
|-|-|
| Id | **FA0703**
| Мнемо | BAD_TYPE_FOR_COLUMNSTORE
| Серьёзность | ⛔ Ошибка
| Категория | [Сбой](./Категория_Сбой.md), [Индексы](./Группа_Индексы.md)
| Исходный код | [BadTypeForColumnstoreIndexRule.cs](../../../Rules/Failure/BadTypeForColumnstoreIndexRule.cs)

## Причина

Правило срабатывает, если COLUMNSTORE индекс содержит столбцы, тип которых не поддерживается.
<p id="descr">Удалите столбцы, тип которых не поддерживается, или откажитесь от кластерного индекса.</p>

## Примеры

Некорректно

```sql
CREATE TABLE dbo.Orders
(
    dt             DATETIME   NOT NULL
    , SignType     INT        NULL
    , OrderChannel ROWVERSION NULL
    , Flags        XML        NULL
);
GO

CREATE CLUSTERED COLUMNSTORE INDEX clcs_Orders
    ON dbo.Orders
    WITH (DATA_COMPRESSION = COLUMNSTORE_ARCHIVE);
GO
```

Корректно

```sql
CREATE TABLE dbo.Orders
(
    dt             DATETIME NOT NULL
    , SignType     INT      NULL
    , OrderChannel INT      NULL
    , Flags        BIGINT   NULL
);
GO

CREATE CLUSTERED COLUMNSTORE INDEX clcs_Orders
    ON dbo.Orders
    WITH (DATA_COMPRESSION = COLUMNSTORE_ARCHIVE);
GO
```

## Ссылки

💡 [Ограничения и запреты COLUMNSTORE](https://learn.microsoft.com/ru-ru/sql/t-sql/statements/create-columnstore-index-transact-sql?view=sql-server-ver16#LimitRest)
