

# Функция не может содержать такую команду

|||
|-|-|
| Id | **FA0978**
| Мнемо | FUNCTION_HAS_ILLEGAL_CODE
| Серьёзность | ⛔ Ошибка
| Категория | [Сбой](./Категория_Сбой.md)
| Исходный код | [FunctionHasIllegalCodeRule.cs](../../../Rules/Failure/FunctionHasIllegalCodeRule.cs)

## Причина

Правило срабатывает, если в функции применили недопустимое выражение.
<p id="descr">Удалите недопустимое выражение из функции.</p>

## Примеры

Некорректно

```sql
CREATE FUNCTION dbo.func (@value INT, @divider INT)
RETURNS INT
AS
BEGIN
    DECLARE @res INT;
    
    IF @divider = 0
        RAISERROR('Divide by zero error encountered', 16, 1);

    SET @res = @value / @divider;

    RETURN @res;
END;
```

Корректно

```sql
CREATE FUNCTION dbo.func (@value INT, @divider INT)
RETURNS INT
AS
BEGIN
    DECLARE @res INT;

    SET @res = @value / @divider;

    RETURN @res;
END;
```

## Подсказки

⚠️ Некоторые выражения в функциях применять недопустимо: THROW, RAISERROR, EXEC

## Ссылки

[Создание определяемых пользователем функций](https://learn.microsoft.com/ru-ru/sql/relational-databases/user-defined-functions/create-user-defined-functions-database-engine?view=sql-server-ver16&redirectedfrom=MSDN#Restrictions)