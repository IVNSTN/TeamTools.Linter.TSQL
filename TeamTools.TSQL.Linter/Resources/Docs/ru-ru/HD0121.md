

# Явное перечисление секций

|||
|-|-|
| Id | **HD0121**
| Мнемо | PARTITIONS_HARDCODED
| Серьёзность | ⚠ Предупреждение
| Категория | [Хардкод](./Категория_Хардкод.md)
| Исходный код | [PartitionRangeListRule.cs](../../../Rules/Hardcode/PartitionRangeListRule.cs)

## Причина

Правило срабатывает при обнаружении явного перечисления секций в опциях сжатия на партиционированных таблицах и индексах.
<p id="descr">Уберите явное перечисление секций и укажите гранулярность сжатия единожды.</p>

## Примеры

Некорректно

```sql
CREATE TABLE dbo.my_table
(
    id INT NOT NULL PRIMARY KEY CLUSTERED WITH (DATA_COMPRESSION = PAGE ON PARTITIONS(1), DATA_COMPRESSION = PAGE ON PARTITIONS(2))
)
WITH (DATA_COMPRESSION = PAGE ON PARTITIONS(1), DATA_COMPRESSION = PAGE ON PARTITIONS(2));

CREATE INDEX IX_FOO
    ON dbo.BAR (t)
    WITH (DATA_COMPRESSION = PAGE ON PARTITIONS(1), DATA_COMPRESSION = PAGE ON PARTITIONS(2))
    ON f(r);
```

Корректно

```sql
CREATE TABLE dbo.my_table
(
    id INT NOT NULL PRIMARY KEY CLUSTERED WITH (DATA_COMPRESSION = PAGE)
)
WITH (DATA_COMPRESSION = PAGE);

CREATE INDEX IX_FOO
    ON dbo.BAR (t)
    WITH (DATA_COMPRESSION = PAGE)
    ON f(r);
```

## Подсказки

💡Вместо перечисления секций укажите гранулярность сжатия единожды:

```sql
WITH (DATA_COMPRESSION = PAGE)
WITH (DATA_COMPRESSION = COLUMNSTORE_ARCHIVE)
```
