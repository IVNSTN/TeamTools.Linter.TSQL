

# Выход при ROWCOUNT=0 не реализован

|||
|-|-|
| Id | **PF0140**
| Мнемо | TRIGGER_EXIT_ON_NO_ROWS
| Серьёзность | ⚠ Предупреждение
| Категория | [Производительность](./Категория_Производительность.md), [Триггеры](./Группа_Триггеры.md)
| Исходный код | [TriggerExitIfNoRowsRule.cs](../../../Rules/Performance/TriggerExitIfNoRowsRule.cs)

## Причина

<p id="descr">Триггер не начинается с проверки, что количество строк ненулевое, и выхода, если это так.</p>

## Примеры

Некорректно

```sql
CREATE TRIGGER dbo.acc_types_u_after
ON dbo.acc_types
AFTER UPDATE
AS
BEGIN
    SET NOCOUNT ON;
```

Корректно

```sql
CREATE TRIGGER dbo.acc_types_u_after
ON dbo.acc_types
AFTER UPDATE
AS
BEGIN
    IF @@ROWCOUNT = 0
    BEGIN
        RETURN;
    END;

    SET NOCOUNT ON;
```

## Подсказки

💡 В основном контролируется единообразие поведения триггеров и их реализации. В начале любого триггера ожидается блок:
```sql
IF @@ROWCOUNT = 0
BEGIN
    RETURN;
END
```
Перед данным блоком допускаются только комментарии.

💡 Для получения количества строк рекомендуется выполнять SELECT COUNT из служебных таблиц, так как в случае выполнения MERGE переменная @@ROWCOUNT может содержать некорректное значение.
