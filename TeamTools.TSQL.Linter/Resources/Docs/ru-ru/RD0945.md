

# Избыточное указание прав конкретного объекта, когда права выданы на уровне схемы

|||
|-|-|
| Id | **RD0945**
| Мнемо | REDUNDANT_GRANT
| Серьёзность | ⚠ Предупреждение
| Категория | [Избыточность](./Категория_Избыточность.md)
| Исходный код | [RedundantGrantRule.cs](../../../Rules/Redundancy/RedundantGrantRule.cs)

## Причина

Правило срабатывает, если обнаружена выдача прав на конкретный объект, когда уже выдано разрешение на схему.
<p id="descr">Удалите определение разрешений на объект. Права уже выданы на схему.</p>

## Примеры

Некорректно

```sql
GRANT UPDATE ON dbo.bar
TO usr1;

GRANT SELECT, EXECUTE, UPDATE ON SCHEMA::dbo
TO usr1;
```

Корректно

```sql
GRANT SELECT, EXECUTE, UPDATE ON SCHEMA::dbo
TO usr1;
```

## Подсказки

💡 Учитывается, что разрешение должно быть выдано тому же участнику и именно такое же разрешение (INSERT, EXECUTE, REFERENCES и подобные).

⚠️ REVOKE не анализирует.

⚠️ Правило обрабатывает только верхнеуровневые выражения. Если выражения находятся в теле хранимой процедуры, то не анализирует, т.к. там может быть сложный алгоритм попадания в одно или другое выражение раздачи привилегий. Наличие в бизнес-логике управления серверными привилегиями проверяется в правиле [VU0512](./VU0512.md).
