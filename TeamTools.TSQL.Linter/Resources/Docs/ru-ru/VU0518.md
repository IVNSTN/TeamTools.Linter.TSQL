

# Вероятно небезопасное переключение контекста пользователя на владельца схемы

|||
|-|-|
| Id | **VU0518**
| Мнемо | EXECUTE_AS_OWNER
| Серьёзность | ℹ Подсказка
| Категория | [Уязвимость](./Категория_Уязвимость.md)
| Исходный код | [ExecuteAsOwnerRule.cs](../../../Rules/Vulnerability/ExecuteAsOwnerRule.cs)

## Причина

Правило срабатывает при обнаружении опции WITH EXECUTE AS OWNER.
<p id="descr">Удалите опцию WITH EXECUTE AS OWNER.</p>

## Примеры

Некорректно

```sql
CREATE PROCEDURE dbo.foo
WITH EXECUTE AS OWNER
AS
    SELECT 1;
```

Корректно

```sql
CREATE PROCEDURE dbo.foo
AS
    SELECT 1;
```

## Подсказки

💡 В большинстве случаев все схемы системы имеют одного владельца. Поэтому переход к AS OWNER открывает почти неограниченные возможности вызывающему текущую процедуру, что небезопасно.

💡 Опция WITH EXECUTE AS CALLER является значением по умолчанию, допускается не указывать ее явно при создании процедуры.
